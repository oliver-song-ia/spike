# Configurations for upper body only training
dataset: 'CUSTOM'
device_args: 0
seed: 0
model: 'SPiKE'
wandb_project: 'hpe'
mode_train: false
mode_val: true
use_valid_only: true

# Data paths
experiments_path: '/home/oliver/Documents/SPiKE/'
dataset_path: '/media/oliver/SSD/Mocap-full/Mocap_dataset'


# input
frames_per_clip: 3
frame_interval: 1
num_points: 4096
target_frame: 'last'

#threshold (in mm - should match data scale)
threshold: 100.0

# point spatial convolution
radius: 0.2
nsamples: 32
spatial_stride: 32

# transformer
dim: 1024
depth: 5
heads: 8
dim_head: 256
mlp_dim: 2048
dropout1: 0.0
dropout2: 0.0


# training
batch_size: 24
epochs: 50
workers: 8
lr: 0.001
momentum: 0.9
weight_decay: 1e-4
lr_milestones:
  - 20
  - 30
lr_gamma: 0.1
lr_warmup_epochs: 5
# output
log_dir: "log"
    # resume
resume: ''
start_epoch: 0
    # losses
loss_type: 'weighted_l1'
# Joint weights for upper body only training
# Upper body joints: weight = 1.0
# Lower body joints: weight = 0.0 (no loss contribution)
joint_weights:
  # Upper body group weights
  shoulder: 1.0      # R/L Shoulder weight
  elbow: 1.0         # R/L Elbow weight
  hand: 1.0          # R/L Hand weight
  # Lower body group weights (set to 0)
  hip: 0.0           # R/L Hip weight
  knee: 0.0          # R/L Knee weight
  foot: 0.0          # R/L Foot weight
  default: 1.0       # Head, Neck, Torso weight
  # Individual joint weights for precise control
  individual:
    "Head": 1.0      # Upper body
    "Neck": 1.0      # Upper body
    "R Shoulder": 1.0 # Upper body
    "L Shoulder": 1.0 # Upper body
    "R Elbow": 1.0   # Upper body
    "L Elbow": 1.0   # Upper body
    "R Hand": 1.0    # Upper body
    "L Hand": 1.0    # Upper body
    "Torso": 1.0     # Upper body
    "R Hip": 0.0     # Lower body - no loss
    "L Hip": 0.0     # Lower body - no loss
    "R Knee": 0.0    # Lower body - no loss
    "L Knee": 0.0    # Lower body - no loss
    "R Foot": 0.0    # Lower body - no loss
    "L Foot": 0.0    # Lower body - no loss
save: True

PREPROCESS_AUGMENT_TRAIN:
  - name: CenterAug
    p_prob: 1.0
    p_axes:
      - true
      - true
      - true
    apply_on_gt: true

  - name: RotationAug
    p_prob: 0.5
    p_axis: 1
    p_min_angle: -1.57
    p_max_angle: 1.57
    apply_on_gt: true

  - name: MirrorAug
    p_prob: 0.5
    p_axes:
      - true
      - false
      - false
    apply_on_gt: true



PREPROCESS_TEST:
  - name: CenterAug
    p_prob: 1.0
    p_axes:
      - true
      - true
      - true
    apply_on_gt: true